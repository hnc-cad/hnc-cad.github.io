<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Hierarchical neural code tree for controllable CAD model generation.">
  <meta name="keywords" content="CAD, Autocomplete, Controllable, Generation, Transformer, VQ-VAE, Codebook, Hierarchical">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Hierarchical Neural Coding for Controllable CAD Model Generation</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.png">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://samxuxiang.github.io/">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://samxuxiang.github.io/skexgen/index.html">
            SkexGen
          </a>
        </div>
      </div>
    </div>

  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Hierarchical Neural Coding for Controllable CAD Model Generation</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://samxuxiang.github.io/">Xiang Xu</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://www.research.autodesk.com/people/pradeep-kumar-jayaraman/">Pradeep Kumar Jayaraman</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://www.research.autodesk.com/people/joseph-george-lambourne/">Joseph G. Lambourne</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.karlddwillis.com/">Karl D.D. Willis</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.cs.sfu.ca/~furukawa/">Yasutaka Furukawa</a><sup>1</sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Simon Fraser University,</span>
            <span class="author-block"><sup>2</sup>Autodesk Research</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/pdf/www"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/www"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <span class="link-block">
                <a href="www"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/samxuxiang/hnc-cad"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>          
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <img src="./static/images/teaser.png"/>
      <h2 class="subtitle has-text-centered">
        Our system learns high-level design concepts as discrete codes at different levels, 
        enabling more diverse and higher-quality generation; 
        novel user controls while specifying design intent; 
        and autocompleting a partial CAD model under construction.
      </h2>
    </div>
  </div>
</section>


<!-- Import the component -->
<script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.1.1/model-viewer.min.js"></script>
<style>
  model-viewer {
    width: 300px;
    height: 300px;
  }
  </style>

<section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <h3 class="title is-4"><center>Generated CAD Models</center></h3>
      <div id="results-carousel" class="carousel results-carousel">
        <div class="item item-steve">
          <model-viewer alt="test test" src="./static/models/1.glb" shadow-intensity="1" camera-controls touch-action="pan-y"></model-viewer>
        </div>

        <div class="item item-steve">
          <model-viewer alt="test test" src="./static/models/2.glb" shadow-intensity="1" camera-controls touch-action="pan-y"></model-viewer>
        </div>

        <div class="item item-steve">
          <model-viewer alt="test test" src="./static/models/3.glb" shadow-intensity="1" camera-controls touch-action="pan-y"></model-viewer>
        </div>

        <div class="item item-steve">
          <model-viewer alt="test test" src="./static/models/4.glb" shadow-intensity="1" camera-controls touch-action="pan-y"></model-viewer>
        </div>

        <div class="item item-steve">
          <model-viewer src="./static/models/5.glb" ar ar-modes="webxr scene-viewer quick-look" camera-controls poster="./static/models/poster5.png" shadow-intensity="0.56" exposure="0.43" environment-image="legacy" shadow-softness="0.9" auto-rotate> </model-viewer>
        </div>

        <div class="item item-steve">
          <model-viewer alt="test test" src="./static/models/6.glb" shadow-intensity="1" camera-controls touch-action="pan-y"></model-viewer>
        </div>
        
      </div>
    </div>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            We present a novel generative model for Computer Aided Design (CAD) that 
            1) represents high-level design concepts of a CAD model as a three-level hierarchical tree of neural codes, from global part arrangement down to local curve geometry; 
            and 2) controls the generation or completion of CAD models by specifying the target design using a code tree. 
          </p>
          <p>
            A novel variant of a vector quantized VAE with "masked skip connection" extracts design variations as 
            neural codebooks at three levels. Two-stage cascaded auto-regressive transformers learn to generate code trees from 
            incomplete CAD models and then complete CAD models following the intended design. 
            Extensive experiments demonstrate superior performance on conventional tasks such as random generation 
            while enabling novel interaction capabilities on conditional generation tasks.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Paper video. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video</h2>
        <div class="publication-video">
          <iframe src="https://www.youtube.com/embed/xxx"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div>
    <!--/ Paper video. -->
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- DataFormat. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3"> Our Hierarchical Representation</h2>

        <div class="content has-text-justified">
          <p>
            We decomposed a CAD model hierarchically into three levels: Loop defining a 
            closed path of connected curves, Profile defining a closed area in the sketch plane bounded 
            by one outer loop (and optionally some inner loops), and Solid representing a set of extruded sketch profiles, 
            combined to form the entire CAD model.
          </p>
        </div>
        <img src="./static/images/data_representation.png"/>
        <br/>

      </div>
    </div>
    <!--/ DataFormat. -->
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Codebook Learning. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3"> Codebook Learning with Masking </h2>

        <div class="content has-text-justified">
          <p>
            Given a CAD model as a construction sequence (e.g., x, y, S), an MLP and a Transformer encoder convert the input to latent codes and applies vector quantization. 
            A Transformer decoder recovers the full input sequence, conditioned on the quantized code and masked out input. 
            Masking forces the decoder to relate unmasked elements and fill-in missing ones conditioned on the code. 
            This is effective for codebook learning of instance-agnostic design patterns.
          </p>
        </div>
        <img src="./static/images/codebook.png"/>
        <br/>

      </div>
    </div>
    <!--/ Codebook Learning. -->
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!--  Generation Module. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3"> Generation System Overview </h2>

        <div class="content has-text-justified">
          <p>
            Controllable CAD generation consists of two-stage auto-regressive generators. Given a partial CAD model, a model
            encoder converts it to latent embeddings. The first auto-regressive Transformer generates hierarchical neural codes based on
            the latent embeddings. The second auto-regressive Transformer generates a new CAD model conditioned on the predicted neural codes as well the previous partial CAD encoding.
          </p>
        </div>
        <img src="./static/images/gen.png"/>
        <br/>

      </div>
    </div>
    <!--/  Generation Module. -->
  </div>
</section>



<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@inproceedings{xu2023hnc,
  author    = {Xiang Xu, Pradeep Kumar Jayaraman, Joseph G. Lambourne, Karl D.D. Willis, Yasutaka Furukawa},
  title     = {Hierarchical Neural Coding for Controllable CAD Model Generation},
  journal   = {ICML},
  year      = {2023},
}</code></pre>
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h3 class="title is-4">Acknowledgement</h3>
        <div class="content has-text-justified">
          <p>
            This research is partially supported by NSERC Discovery Grants with Accelerator Supplements and DND/NSERC Discovery Grant Supplement.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            We create this website based on the source code of <a
              href="https://github.com/nerfies/nerfies.github.io">Nerfies</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
